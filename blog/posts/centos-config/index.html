<!DOCTYPE html>
<html><title>Centos 配置备忘</title>
<link href="https://fonts.googleapis.com/css?family=Merriweather|Merriweather+Sans:300,400|Nunito" rel="stylesheet">

<link rel="stylesheet" href="../../scss/style.min.css">
<body>
<section id="content">
  <div class="container">
    <h5><a href="/">On The Way</a></h5>
    <h1>Centos 配置备忘</h1>
    <p class="date">Nov 20, 2018 | Reading time: 1 mins</p>
    

<h2 id="一-添加用户">一、添加用户</h2>

<pre><code class="language-bash">// 添加用户
# adduser XXX

// 附加至wheel组
# gpasswd -a XXX wheel
</code></pre>

<h2 id="二-ssh配置">二、SSH配置</h2>

<p>主要修改<code>/etc/ssh/sshd_config</code>文件</p>

<h3 id="1-关闭root远程登录">1. 关闭root远程登录</h3>

<pre><code class="language-bash">PermitRootLogin no
</code></pre>

<h3 id="2-添加证书登录">2. 添加证书登录</h3>

<pre><code class="language-bash">// 生成密钥
ssh-keygen -t rsa

// 至于自制的公钥数据就放置于用户家目录下的 .ssh/authorized_keys 内
RSAAuthentication yes
PubkeyAuthentication yes
</code></pre>

<h3 id="3-禁用密码登陆">3. 禁用密码登陆</h3>

<pre><code class="language-bash">PasswordAuthentication yes -&gt; no
</code></pre>

<h2 id="三-ssocks配置">三、Ssocks配置</h2>

<h3 id="1-安装">1. 安装</h3>

<ul>
<li><p>Pip</p>

<pre><code class="language-bash">$ sudo curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py
</code></pre></li>

<li><p>Ssocks</p>

<pre><code class="language-bash">$ sudo pip install shadowsocks
</code></pre></li>

<li><p>相关库</p>

<pre><code class="language-bash">$ sudo pip install M2Crypto
$ sudo pip install gevent
</code></pre></li>
</ul>

<h3 id="2-添加相应配置文件">2. 添加相应配置文件</h3>

<p><code>\etc\shadowsocks\example.json</code></p>

<pre><code class="language-bash">{
    &quot;server&quot;:&quot;my_server_ip&quot;,
    &quot;server_port&quot;:8388,
    &quot;local_address&quot;: &quot;127.0.0.1&quot;,
    &quot;local_port&quot;:1080,
    &quot;password&quot;:&quot;mypassword&quot;,
    &quot;timeout&quot;:300,
    &quot;method&quot;:&quot;aes-256-cfb&quot;,
    &quot;fast_open&quot;: false,
    &quot;workers&quot;: 1,
    &quot;prefer_ipv6&quot;: false
}
</code></pre>

<h3 id="3-配置启动服务文件">3. 配置启动服务文件</h3>

<p><code>\usr\lib\systemd\system\shadowsocks-server@.service</code></p>

<pre><code class="language-bash">[Unit]
Description=Shadowsocks Server Service
After=network.target

[Service]
Type=simple
User=nobody
ExecStart=/usr/bin/ssserver -c /etc/shadowsocks/%i.json

[Install]
WantedBy=multi-user.target

</code></pre>

<h3 id="4-开启服务">4. 开启服务</h3>

<pre><code class="language-bash">$ sudo systemctl start shadowsocks-server@example
$ sudo systemctl enable shadowsocks-server@example
</code></pre>

<h2 id="四-启动防火墙-添加策略">四、启动防火墙，添加策略</h2>

<h3 id="1-启动服务-并在系统引导时启动该服务">1. 启动服务，并在系统引导时启动该服务：</h3>

<pre><code class="language-bash">$ sudo systemctl start firewalld
$ sudo systemctl enable firewalld
</code></pre>

<h3 id="2-添加策略">2. 添加策略</h3>

<pre><code class="language-bash">// SSH与SS端口
$ sudo firewall-cmd --zone=public --add-port=12345/tcp --permanent
</code></pre>

<h3 id="3-重启防火墙">3. 重启防火墙</h3>

<pre><code class="language-bash">$ sudo firewall-cmd --reload
</code></pre>

    
      <p><a href="../posts">&lt;&lt; Back to Posts</a></p>
    

  </div>
</section>
<footer>
    <p>On The Way &copy; 2018</p>
    <ul class="links">
    
        <li><a href="https://twitter.com/VLVK">Twitter</a></li>
    

    
        <li><a href="https://github.com/vlvk">Github</a></li>
    
    </ul>
</footer></body>
</html>
